FROM node:16.6.1
WORKDIR /app

COPY package*.json ./

RUN npm i
RUN npm i -g nodemon typescript ts-node prisma

COPY prisma ./

RUN prisma generate
RUN prisma migrate deploy

COPY . .

EXPOSE 3000
EXPOSE 4000

CMD nodemon --watch '**/*' --ext 'ts,js,json' --exec 'ts-node src/index.ts'
